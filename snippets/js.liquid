{{ 'main.min.js' | asset_url | script_tag }}

{% if template contains 'product' %}
  {% include 'product-page-js' %}
  {%- if product.images.size > 1 -%}
    <script>
    var slider = tns({
      arrowKeys: true,
      arrows: true,
      container: '#product-images',
      controlsContainer: '#product-images-controls',
      items: 1,
      mode: 'gallery',
      navAsThumbnails: true,
      navContainer: '#product-images-thumbnails',
      speed: 1000
    })
    </script>
  {%- endif -%}
{% endif %}

{% if template contains 'contact' and settings.location_map_enable %}
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBQEu8xtzKHPBnFmcFG-6Ps_mG5uLgP2q8&callback=initMap" async defer></script>
<script>
function initMap() {
  var dot = {lat: {{ settings.location_map_lat }}, lng: {{ settings.location_map_lng }};
  var map = new google.maps.Map(document.getElementById('location-map'), {
    zoom: {{ settings.location_map_zoom }},
    center: dot
  });
  var marker = new google.maps.Marker({
    position: dot,
    map: map
  });
}
</script>
{% endif %}

{% if template contains 'stockists' %}
<script>
(function () {
  var headings = document.querySelectorAll('.stockists-list h2')
  Array.prototype.forEach.call(headings, function (heading) {
    heading.innerHTML = '\n <button aria-expanded="false" class="toggle">\n' + heading.textContent + '\n <svg aria-hidden="true" focusable="false" viewBox="0 0 24 24" width="24" height="24">\n <rect class="vert" height="16" width="2" y="0" x="7"/>\n <rect height="2" width="16" y="7" x="0"/>\n </svg>\n </button>\n'
    var getContent = function getContent (elem) {
      var elems = []
      while (elem.nextElementSibling && elem.nextElementSibling.tagName !== 'H2') {
        elems.push(elem.nextElementSibling)
        elem = elem.nextElementSibling
      }
      elems.forEach(function (node) {
        node.parentNode.removeChild(node)
      })
      return elems
    }
    var contents = getContent(heading)
    var wrapper = document.createElement('div')
    wrapper.className = 'section-group'
    wrapper.hidden = true
    contents.forEach(function (node) {
      wrapper.appendChild(node)
    })
    heading.parentNode.insertBefore(wrapper, heading.nextElementSibling)
    var btn = heading.querySelector('button')
    btn.onclick = function () {
      var expanded = btn.getAttribute('aria-expanded') === 'true' || false
      btn.setAttribute('aria-expanded', !expanded)
      wrapper.hidden = expanded
    }
  })
})()
</script>
{% endif %}

<script>
// Google analytics
new CookiesEuBanner(function(){
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-XXXXXXXX-X', '{{ shop.domain }}');
  ga('send', 'pageview');
}, true)

// Facebook Events
new CookiesEuBanner(function(){
  !function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;
  n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,
  document,'script','//connect.facebook.net/en_US/fbevents.js');
  fbq('init', 'XXXXXXXXXXXXXXX');
  fbq('track', 'PageView');
}, true)
</script>

<noscript>
  <img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=XXXXXXXXXXXXXXX&ev=PageView&noscript=1" alt="">
</noscript>
